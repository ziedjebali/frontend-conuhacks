"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __assign=function(){return(__assign=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function __awaiter(r,o,s,c){return new(s=s||Promise)(function(t,e){function n(t){try{i(c.next(t))}catch(t){e(t)}}function a(t){try{i(c.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,a)}i((c=c.apply(r,o||[])).next())})}function __generator(n,a){var i,r,o,t,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(o=2&e[0]?r.return:e[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,e[1])).done)return o;switch(r=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,r=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){s.label=e[1];break}if(6===e[0]&&s.label<o[1]){s.label=o[1],o=e;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(e);break}o[2]&&s.ops.pop(),s.trys.pop();continue}e=a.call(n,s)}catch(t){e=[6,t],r=0}finally{i=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var cntState={global:0,models:{},effects:{}},createLoadingAction=function(s,c){return function(t,e){var n,a,i,r=e.name,o=e.action;return cntState.global+=c,cntState.models[r]+=c,cntState.effects[r][o]+=c,__assign(__assign({},t),{global:s(cntState.global),models:__assign(__assign({},t.models),(n={},n[r]=s(cntState.models[r]),n)),effects:__assign(__assign({},t.effects),(a={},a[r]=__assign(__assign({},t.effects[r]),(i={},i[o]=s(cntState.effects[r][o]),i)),a))})}},validateConfig=function(t){if(t.name&&"string"!=typeof t.name)throw new Error("loading plugin config name must be a string");if(t.asNumber&&"boolean"!=typeof t.asNumber)throw new Error("loading plugin config asNumber must be a boolean");if(t.whitelist&&!Array.isArray(t.whitelist))throw new Error("loading plugin config whitelist must be an array of strings");if(t.blacklist&&!Array.isArray(t.blacklist))throw new Error("loading plugin config blacklist must be an array of strings");if(t.whitelist&&t.blacklist)throw new Error("loading plugin config cannot have both a whitelist & a blacklist")},index=function(a){void 0===a&&(a={}),validateConfig(a);var i=a.name||"loading",s=!0===a.asNumber?function(t){return t}:function(t){return 0<t},c={name:i,reducers:{hide:createLoadingAction(s,-1),show:createLoadingAction(s,1)},state:__assign({},cntState)};return cntState.global=0,c.state.global=s(cntState.global),{config:{models:{loading:c}},onModel:function(t){var n=this,o=t.name;if(o!==i){cntState.models[o]=0,c.state.models[o]=s(cntState.models[o]),c.state.effects[o]={};var e=this.dispatch[o];Object.keys(e).forEach(function(i){if(!0===n.dispatch[o][i].isEffect){cntState.effects[o][i]=0,c.state.effects[o][i]=s(cntState.effects[o][i]);var t=o+"/"+i;if((!a.whitelist||a.whitelist.includes(t))&&(!a.blacklist||!a.blacklist.includes(t))){var r=n.dispatch[o][i],e=function(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];return __awaiter(n,void 0,void 0,function(){var e,n;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this.dispatch.loading.show({name:o,action:i}),[4,r.apply(void 0,a)];case 1:return e=t.sent(),this.dispatch.loading.hide({name:o,action:i}),[2,e];case 2:throw n=t.sent(),this.dispatch.loading.hide({name:o,action:i}),n;case 3:return[2]}})})};e.isEffect=!0,n.dispatch[o][i]=e}}})}}}};exports.default=index;
//# sourceMappingURL=rematch-loading.cjs.js.map
